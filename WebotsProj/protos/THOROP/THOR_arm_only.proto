#############################################
# THOR-OP webots prototype file 
# Based on VT prototype
# Converted and augmented by SJ
# 2013/1
#############################################

PROTO THOROP [
  field SFVec3f    translation 0 1 0
  field SFRotation rotation 0 1 0 0
  field SFString   controller "void"
  field SFString   controllerArgs ""
  field SFBool     synchronization TRUE
  field SFString   name "THOR_arm_only"
#  field SFColor    plasticColor 0.301961 0.301961 0.301961
  field SFVec2f    cameraWindowPosition 0 0
  field SFFloat    cameraPixelSize 1.0
  field SFInt32    cameraWidth 160
  field SFInt32    cameraHeight 120
#  field SFInt32    channel 0
]
{
Robot {
  translation IS translation
  rotation IS rotation
  controller IS controller
  controllerArgs IS controllerArgs
  synchronization IS synchronization
  name IS name

  children [


    Servo {
      translation 0 0 -0.60
      children [
        DEF BASE_SHAPE1 Shape{
           geometry BOX{size 0.05 0.05 0.60}
        }
      ]
      boundingObject Transform{
        translation 0 0 -0.60
        children [USE BASE_SHAPE1]
      }
      physics Physics{}
    }
 






    DEF chest_yaw Servo {
      translation -0.023 0 0.74
      rotation 0 0 1 0
      children [
        DEF r_shoulder_pitch Servo {
          translation 0 -0.219 0
          children [
            DEF r_shoulder_roll Servo {
              rotation 1 0 0 0
              children [
                DEF r_shoulder_yaw Servo {
                  translation 0 0 -0.039
                  rotation 0 0 1 0
                  children [
                    DEF r_elbow_pitch Servo {
                      translation 0.02991 0 -0.208
                      children [
                        DEF r_wrist_yaw Servo {
                          translation -0.02961 0 -0.187
                          rotation 0 0 1 0
                          children [
                            DEF r_wrist_roll Servo {
                              translation 0 0 -0.0543
                              rotation 1 0 0 0

                              children [
  	   	  	        Transform{   #Palm
             			  translation 0 0 -0.065
                                  children [
                                    Shape{geometry Box {size 0.02 0.05 0.05}}
	                          ]
			        }
				DEF r_wrist_grip1 Servo{ #First finger for gripper
				  translation 0 0.02 -0.04
				  rotation 1 0 0 0.78
				  name "r_wrist_grip1"
				  children[
				    Transform{
                              	      translation 0 0 -0.05
                                      children [
                                        Shape{geometry Box {size 0.02 0.02 0.10}}
				      ]
                                    }
				  ]
				  boundingObject Transform {
                            	    translation 0 0 -0.05
                                    children [
                                      Box {size 0.02 0.02 0.10}
                                    ]
                                  }
                                  physics Physics {}
				}
	   	 	        DEF r_wrist_grip2 Servo{ #Second finger for gripper
				  translation 0 -0.02 -0.08
				  rotation 1 0 0 0.78
				  name "r_wrist_grip2"
				  children[
				    Transform{
                              	      translation 0 0 -0.05
                                      children [
                                        Shape{geometry Box {size 0.02 0.02 0.10}}
				      ]
                                    }
				  ]
				  boundingObject Transform {
                            	    translation 0 0 -0.05
                                    children [
                                      Box {size 0.02 0.02 0.10}
                                    ]
                                  }
                                  physics Physics {}
				}

                                DEF r_wrist_roll Transform {
                                  rotation 1 0 0 1.57
                                  children [
				     WRIST_ROLL{}
                                  ]
				}
			      ]
                              name "r_wrist_roll"
                              boundingObject Transform {
                                translation 0 0 -0.0095
                                children [
                                  Box {size 0.096 0.042 0.059}
                                ]
                              }
                              physics Physics {}
                            }
                            DEF r_wrist_yaw Transform {
                              rotation 1 0 0 1.57
                              children [
 				WRIST_YAW{}
                              ]
                            }
                          ]
                          name "r_wrist_yaw"
                          boundingObject Transform {
                            translation 0 0 -0.0375
                            children [
                              Box {size 0.09 0.048 0.075}
                            ]
                          }
                          physics Physics {}
                          maxForce 10000
                        }
                        DEF r_elbow_pitch Transform {
                          rotation 1 0 0 1.57
                          children [
                            ELBOW_PITCH{}
                          ]
                        }
                      ]
                      name "r_elbow_pitch"
                      boundingObject Transform {
                        translation -0.0185 0 -0.084
                        children [
                          Box {size 0.077 0.12 0.208}
                        ]
                      }
                      physics Physics {}
                      maxForce 10000
                    }
                    DEF r_shoulder_yaw Transform {
                      rotation 1 0 0 1.57
                      children [
                        SHOULDER_YAW{}
                      ]
                    }
                  ]
                  name "r_shoulder_yaw"
                  boundingObject Transform {
                    translation 0.0175 0 -0.123
                    children [
                      Box {size 0.102 0.114 0.246}
                    ]
                  }
                  physics Physics {}
                  maxForce 10000
                }
                DEF r_shoulder_roll Transform {
                  rotation 1 0 0 1.57
                  children [
                    SHOULDER_ROLL{}
                  ]
                }
              ]
              name "r_shoulder_roll"
              boundingObject Transform {
                translation 0 0 -0.006
                children [
                  Box {size 0.138 0.054 0.066}
                ]
              }
              physics Physics {}
              maxForce 10000
            }
            DEF r_shoulder_pitch Transform {
              rotation -1 0 0 1.57
              children [
                SHOULDER_PITCH{}
              ]
            }
          ]
          name "r_shoulder_pitch"
          boundingObject Transform {
            translation 0 0.027 0
            children [
              Box {size 0.144 0.108 0.054}
            ]
          }
          physics Physics {
            centerOfMass 0 -0.027 0
          }
          maxForce 10000

        }



        DEF neck_yaw Servo {
          translation 0 0 0.027
          rotation 0 0 1 0
          children [
            DEF head_pitch Servo {
              translation 0 0 0.114
              children [
                DEF head_pitch Transform {
                  rotation 1 0 0 1.57
                  children[
  	            HEAD_PITCH{}
		    Transform{
		      translation 0.03 0.07 0
		      rotation 0 1 0 -1.57
 		      children[
			#ADDED FOR DEPTH SENSING
#			DEF kinect KinectWithoutFoot{}
		      ]		      
		    }
                  ]
                }
              ]
              name "head_pitch"
 	      boundingObject Transform {
                children [
                  Box {size 0.05 0.05 0.05}
                ]
              }
            }
            DEF neck_yaw Transform {
              rotation 1 0 0 1.57
              children [
                NECK_YAW{}
              ]
            }
          ]
          name "neck_yaw"
          boundingObject Transform {
            children [
              Box {size 0.05 0.05 0.05}
            ]
          }
        }
        DEF upper_torso_yaw Transform {
          rotation 1 0 0 1.57
          children [
            UPPER_TORSO_YAW{}
          ]
        }
      ]
      name "chest_yaw"
      boundingObject Transform {
        translation 0 0 -0.058
        children [
          Box {size 0.06 0.276 0.171}
        ]
      }
      physics Physics {}
      maxForce 10000

    }
    DEF lower_torso Transform {
      translation -0.023 0 0.287
      rotation -1 0 0 -1.57
      children [
        LOWER_TORSO{}
      ]
    }
    DEF zero GPS {
       translation -0.023 0 0.596
       name "zero"
    }
    Compass {
       translation -0.023 0 0.596
       name "compass"
    }
    Accelerometer {
      translation 0.027711 0 0.23735
#     rotation 1 0 0 1.5708
      name "Accelerometer"
      lookupTable [
          -39.24 0 0
           39.24 1024 0
      ]
    }
    Gyro {
      translation 0.027711 0 0.23735
 #    rotation -0.57735 0.57735 0.57735 2.0944
      name "Gyro"
      lookupTable [
        -27.925 0 0
        27.925 1024 0
      ]
    }
#SH: those are for sending/receiving team messages
    DEF RECEIVER Receiver {
      name "receiver"
      channel IS channel
    }
    DEF EMITTER Emitter {
      name "emitter"
      channel IS channel
    }

    DEF PHYSICS_RECEIVER Receiver {
      name "physics_receiver"
      type "serial"
      channel 10
      byteSize 192
    }
    DEF PHYSICS_EMITTER Emitter {
      name "physics_emitter"
      type "serial"
      byteSize 96
    }
  ]
  name "THOROP" # Lower Torso
  boundingObject Transform {
#    translation -0.0115 0 0.4115
    translation -0.0115 0 -0.3
    children [
      Box {
#        size 0.143 0.234 0.367
        size 0.5 1.0 0.05  
      }
    ]
  }
  physics Physics {
    density -1
    mass 9.846
    centerOfMass -0.015 0 0.427
  }
  controller "void"
  is_locked TRUE
}

}
